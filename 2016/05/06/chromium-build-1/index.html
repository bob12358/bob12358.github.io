<!doctype html>



  


<html class="theme-next pisces use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="chromium," />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta name="description" content="参考资料:谷歌Chromium官网 https://www.chromium.org/developers/how-tos/get-the-code 关键部分:1. 问题1执行ninja -C out/Default chrome后,">
<meta name="keywords" content="chromium">
<meta property="og:type" content="article">
<meta property="og:title" content="Chromium编译问题总结">
<meta property="og:url" content="http://junchaozhang.github.io/2016/05/06/chromium-build-1/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="参考资料:谷歌Chromium官网 https://www.chromium.org/developers/how-tos/get-the-code 关键部分:1. 问题1执行ninja -C out/Default chrome后,">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2017-10-20T14:21:41.520Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chromium编译问题总结">
<meta name="twitter:description" content="参考资料:谷歌Chromium官网 https://www.chromium.org/developers/how-tos/get-the-code 关键部分:1. 问题1执行ninja -C out/Default chrome后,">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>

  <title> Chromium编译问题总结 | Hexo </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-74882139-1', 'auto');
  ga('send', 'pageview');
</script>


  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?a80a7556a58bfa2064aaf8976a7aff02";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>








  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Hexo</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="#" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup">
 <span class="search-icon fa fa-search"></span>
 <input type="text" id="local-search-input">
 <div id="local-search-result"></div>
 <span class="popup-btn-close">close</span>
</div>


    </div>
  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                Chromium编译问题总结
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-05-06T23:17:27+00:00" content="2016-05-06">
              2016-05-06
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/调试/" itemprop="url" rel="index">
                    <span itemprop="name">调试</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/05/06/chromium-build-1/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/05/06/chromium-build-1/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>参考资料:<br>谷歌Chromium官网 <a href="https://www.chromium.org/developers/how-tos/get-the-code" target="_blank" rel="external">https://www.chromium.org/developers/how-tos/get-the-code</a></p>
<h2 id="关键部分"><a href="#关键部分" class="headerlink" title="关键部分:"></a>关键部分:</h2><h3 id="1-问题1"><a href="#1-问题1" class="headerlink" title="1. 问题1"></a>1. 问题1</h3><p>执行<code>ninja -C out/Default chrome</code>后,<br><a id="more"></a><br><figure class="highlight subunit"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">ERROR </span>at //ui/accessibility/BUILD.gn:16:19: Script returned non-zero exit code.</div><div class="line">    atk_lib_dir = exec_script(pkg_config_script,</div><div class="line">                  ^----------</div><div class="line">Current dir: /opt/chromiumorg/chromium/src/out/Default/</div><div class="line">Command: python -- /opt/chromiumorg/chromium/src/build/config/linux/pkg-config.py --libdir atk</div><div class="line">Returned 1 and printed out:</div><div class="line"></div><div class="line"><span class="keyword">Error </span>from pkg-config.</div><div class="line"></div><div class="line">stderr:</div><div class="line"></div><div class="line">Package atk was not found in the pkg-config search path.</div><div class="line">Perhaps you should add the directory containing `atk.pc'</div><div class="line">to the PKG_CONFIG_PATH environment variable</div><div class="line">No package 'atk' found</div><div class="line"></div><div class="line">See //BUILD.gn:171:7: which caused the file to be included.</div></pre></td></tr></table></figure></p>
<h4 id="解决"><a href="#解决" class="headerlink" title="解决:"></a>解决:</h4><h5 id="1-下载atk安装包"><a href="#1-下载atk安装包" class="headerlink" title="1. 下载atk安装包"></a>1. 下载atk安装包</h5><p><a href="http://www.linuxfromscratch.org/blfs/view/svn/x/atk.html" target="_blank" rel="external">http://www.linuxfromscratch.org/blfs/view/svn/x/atk.html</a></p>
<h5 id="2-编译安装atk"><a href="#2-编译安装atk" class="headerlink" title="2. 编译安装atk:"></a>2. 编译安装atk:</h5><h5 id="3-编译安装pango"><a href="#3-编译安装pango" class="headerlink" title="3. 编译安装pango:"></a>3. 编译安装pango:</h5><p>将configure中的:<br><figure class="highlight ini"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="attr">have_cairo</span>=<span class="literal">true</span>  </div><div class="line"><span class="attr">have_cairo_png</span>=<span class="literal">true</span>  </div><div class="line"><span class="attr">have_cairo_freetype</span>=<span class="literal">true</span></div></pre></td></tr></table></figure></p>
<p>修改,编译安装</p>
<h5 id="4-编译安装nss-The-Network-Security-Services-NSS-package"><a href="#4-编译安装nss-The-Network-Security-Services-NSS-package" class="headerlink" title="4. 编译安装nss(The Network Security Services (NSS) package)"></a>4. 编译安装nss(The Network Security Services (NSS) package)</h5><p><a href="http://www.linuxfromscratch.org/blfs/view/svn/postlfs/nss.html" target="_blank" rel="external">http://www.linuxfromscratch.org/blfs/view/svn/postlfs/nss.html</a></p>
<h3 id="2-问题2"><a href="#2-问题2" class="headerlink" title="2. 问题2"></a>2. 问题2</h3><p>执行<br><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ninja -<span class="keyword">C</span> out_amd64-generic/<span class="keyword">Release</span> -j1 chrome chrome_sandbox nacl_helper</div></pre></td></tr></table></figure></p>
<p>Error Log:</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">..</span>/<span class="built_in">..</span>/third_party/llvm-build/Release+Asserts/bin/clang++ -MMD -MF obj/base/base/linux_util.o.d -DUSE_SYMBOLIZE -DV8_DEPRECATION_WARNINGS <span class="attribute">-DENABLE_MDNS</span>=1 -DENABLE_NOTIFICATIONS -DENABLE_PEPPER_CDMS <span class="attribute">-DENABLE_PLUGINS</span>=1 <span class="attribute">-DENABLE_PDF</span>=1 <span class="attribute">-DENABLE_PRINTING</span>=1 <span class="attribute">-DENABLE_BASIC_PRINTING</span>=1 <span class="attribute">-DENABLE_PRINT_PREVIEW</span>=1 <span class="attribute">-DENABLE_SPELLCHECK</span>=1 -DUSE_UDEV -DUI_COMPOSITOR_IMAGE_TRANSPORT <span class="attribute">-DUSE_AURA</span>=1 <span class="attribute">-DUSE_PANGO</span>=1 <span class="attribute">-DUSE_CAIRO</span>=1 <span class="attribute">-DUSE_CLIPBOARD_AURAX11</span>=1 <span class="attribute">-DUSE_DEFAULT_RENDER_THEME</span>=1 <span class="attribute">-DUSE_GLIB</span>=1 <span class="attribute">-DUSE_NSS_CERTS</span>=1 <span class="attribute">-DUSE_X11</span>=1 <span class="attribute">-DENABLE_WEBRTC</span>=1 <span class="attribute">-DENABLE_EXTENSIONS</span>=1 <span class="attribute">-DENABLE_TASK_MANAGER</span>=1 <span class="attribute">-DENABLE_THEMES</span>=1 <span class="attribute">-DENABLE_CAPTIVE_PORTAL_DETECTION</span>=1 <span class="attribute">-DENABLE_SESSION_SERVICE</span>=1 <span class="attribute">-DENABLE_APP_LIST</span>=1 <span class="attribute">-DENABLE_SETTINGS_APP</span>=1 <span class="attribute">-DENABLE_SUPERVISED_USERS</span>=1 <span class="attribute">-DENABLE_SERVICE_DISCOVERY</span>=1 <span class="attribute">-DENABLE_AUTOFILL_DIALOG</span>=1 <span class="attribute">-DENABLE_TOPCHROME_MD</span>=1 -DFULL_SAFE_BROWSING -DSAFE_BROWSING_CSD -DSAFE_BROWSING_DB_LOCAL -DCHROMIUM_BUILD <span class="attribute">-DENABLE_MEDIA_ROUTER</span>=1 -DFIELDTRIAL_TESTING_ENABLED <span class="attribute">-DCR_CLANG_REVISION</span>=267383-1 <span class="attribute">-D_FILE_OFFSET_BITS</span>=64 -D_LARGEFILE_SOURCE -D_LARGEFILE64_SOURCE -D__STDC_CONSTANT_MACROS -D__STDC_FORMAT_MACROS -D_DEBUG <span class="attribute">-DDYNAMIC_ANNOTATIONS_ENABLED</span>=1 <span class="attribute">-DWTF_USE_DYNAMIC_ANNOTATIONS</span>=1 <span class="attribute">-D_GLIBCXX_DEBUG</span>=1 -DBASE_IMPLEMENTATION -I<span class="built_in">..</span>/<span class="built_in">..</span> -Igen -I<span class="built_in">..</span>/<span class="built_in">..</span>/build/linux/debian_wheezy_amd64-sysroot/usr/local/include/glib-2.0 -I<span class="built_in">..</span>/<span class="built_in">..</span>/build/linux/debian_wheezy_amd64-sysroot/usr/local/lib/glib-2.0/include -fno-strict-aliasing <span class="attribute">--param</span>=ssp-buffer-size=4 -fstack-protector -funwind-tables -fPIC -pipe -B<span class="built_in">..</span>/<span class="built_in">..</span>/third_party/binutils/Linux_x64/Release/bin -fcolor-diagnostics <span class="attribute">-fdebug-prefix-map</span>=/opt/chromiumorg/chromium/src=. -pthread -m64 <span class="attribute">-march</span>=x86-64 -Wall -Werror -Wextra -Wno-missing-field-initializers -Wno-unused-parameter -Wno-c++11-narrowing -Wno-covered-switch-default -Wno-deprecated-register -Wno-unneeded-internal-declaration -Wno-inconsistent-missing-override -Wno-shift-negative-value -Wno-undefined-var-template -O0 -g2 -gsplit-dwarf <span class="attribute">--sysroot</span>=../../build/linux/debian_wheezy_amd64-sysroot <span class="attribute">-fvisibility</span>=hidden -Xclang -load -Xclang <span class="built_in">..</span>/<span class="built_in">..</span>/third_party/llvm-build/Release+Asserts/lib/libFindBadConstructs.so -Xclang -add-plugin -Xclang find-bad-constructs -Xclang -plugin-arg-find-bad-constructs -Xclang check-templates -Xclang -plugin-arg-find-bad-constructs -Xclang follow-macro-expansion -Xclang -plugin-arg-find-bad-constructs -Xclang check-implicit-copy-ctors -Xclang -plugin-arg-find-bad-constructs -Xclang check-ipc -Wheader-hygiene -Wstring-conversion -Wno-char-subscripts -Wexit-time-destructors -fno-threadsafe-statics -fvisibility-inlines-hidden -Wno-undefined-bool-conversion -Wno-tautological-undefined-compare <span class="attribute">-std</span>=gnu++11 -fno-rtti -fno-exceptions -c <span class="built_in">..</span>/<span class="built_in">..</span>/base/linux_util.cc -o obj/base/base/linux_util.o</div><div class="line">Release/gen/library_loaders/libgio.h ::19: error: gio/gio.h file <span class="keyword">not</span> found</div><div class="line">   #include &lt;gio/gio.h&gt;</div><div class="line">                  </div><div class="line">1 <span class="builtin-name">error</span> generated.</div><div class="line">ninja: build stopped: subcommand failed</div></pre></td></tr></table></figure>
<p>Solve:</p>
<pre><code>1. 首先我先google了一遍,并且在chromium-dev讨论组中搜索,但没什么结果
2. 怀疑是include path 的问题 于是查看gcc -v ,发现路径中含有/usr/include,照着 http://linuxintro.org/wiki/Error_messages_and_their_solutions#gio操作:
</code></pre><figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Symptom, <span class="keyword">in</span> <span class="keyword">this</span> <span class="keyword">case</span> building from <span class="string">gqcam:</span></div><div class="line"><span class="regexp">/usr/</span>include<span class="regexp">/gdk/</span>gdkapplaunchcontext.<span class="string">h:</span><span class="number">30</span>:<span class="number">21</span>: fatal <span class="string">error:</span> gio/gio.<span class="string">h:</span> No such file or directory</div><div class="line">Solution, <span class="keyword">in</span> <span class="keyword">this</span> <span class="keyword">case</span> <span class="keyword">for</span> SUSE Linux <span class="number">11.3</span>:</div><div class="line">cp -r <span class="regexp">/usr/</span>include<span class="regexp">/glib-2.0/</span>gio<span class="regexp">/ /</span>usr<span class="regexp">/include/</span></div></pre></td></tr></table></figure>
<p>问题依旧</p>
<ol>
<li>发现报错信息中执行的是clang++ 找到这个目录,发现clang++的include目录在:<br><code>/home/dev/Develop/chromiumorg/chromium/src/third_party/llvm-build/Release+Asserts/lib/clang/3.9.0/include</code><br>将/usr/include中的所有文件复制到该目录,问题解决.</li>
</ol>
<h3 id="3-问题3"><a href="#3-问题3" class="headerlink" title="3. 问题3"></a>3. 问题3</h3><figure class="highlight crystal"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/opt/chromiumorg/chromium/src/third_party/llvm-build/Release+Asserts/bin/../<span class="class"><span class="keyword">lib</span>/<span class="title">clang</span>/3.9.0/<span class="title">include</span>/<span class="title">linux</span>/<span class="title">sysinfo</span>.<span class="title">h</span>:10:2: <span class="title">error</span>: <span class="title">unknown</span> <span class="title">type</span> <span class="title">name</span> '<span class="title">__kernel_ulong_t</span>'</span></div></pre></td></tr></table></figure>
<p>Solve:</p>
<ol>
<li>grep  -r “__kernel_ulong_t” . 先看看这个变量在什么地方<br>将<code>/usr/include/asm-generic/posix-types.h</code>的:</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> __kernel_long_t</span></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span>            <span class="keyword">__kernel_long_t</span>;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span>   <span class="keyword">__kernel_ulong_t</span>;</div><div class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></div></pre></td></tr></table></figure>
<p>添加到<br> <code>/home/dev/Develop/chromiumorg/chromium/src/build/linux/debian_wheezy_amd64-sysroot/usr/include/x86_64-linux-gnu/asm/posix-types.h</code></p>
<h3 id="4-问题4"><a href="#4-问题4" class="headerlink" title="4. 问题4"></a>4. 问题4</h3><p>build error. Initial unount failed. Possibly crosbug.com/23443</p>
<p>When I build:<br><code>ninja -C out_amd64-generic/Release -j1 chrome chrome_sandbox nacl_helper</code></p>
<figure class="highlight subunit"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line">losetup: /dev/loop2: detach failed: No such device or address</div><div class="line">WARNING : losetup -d /dev/loop2 failed (try 1)</div><div class="line">+ sudo losetup -a</div><div class="line">/dev/loop0: [0045]:694630 (/home/dev/test.dat)</div><div class="line">/dev/loop1: [0045]:694630 (/home/dev/test.dat)</div><div class="line">+ grep -H /dev/loop2 /proc/mounts</div><div class="line">+ true</div><div class="line">+ set +x</div><div class="line">losetup: /dev/loop2: detach failed: No such device or address</div><div class="line">WARNING : losetup -d /dev/loop2 failed (try 2)</div><div class="line"></div><div class="line">and build .</div><div class="line">then get an error:</div><div class="line"></div><div class="line"></div><div class="line">plain floppy: device "/proc/950/fd/3" busy (Resource temporarily unavailable):</div><div class="line">Cannot initialize 'S:'</div><div class="line">Bad target s:/ldlinux.sys</div><div class="line">syslinux: failed to create ldlinux.sys</div><div class="line"><span class="keyword">ERROR   </span>: 2016年 05月 05日 星期四 15:28:00 CST</div><div class="line"><span class="keyword">ERROR   </span>:  PGID  PPID   PID     ELAPSED     TIME %CPU COMMAND</div><div class="line"><span class="keyword">ERROR   </span>:     6     6    10       13:01 00:00:00  0.0 /bin/bash ./build_image --board=amd64-generic --noenable_rootfs_verification dev</div><div class="line"><span class="keyword">ERROR   </span>:     6    10 30796       00:24 00:00:00  0.2  \_ /bin/bash /mnt/host/source/src/scripts/bin/cros_make_image_bootable/mnt/host/source/src/build/images/amd64-generic/R52<span class="string">-8277</span>.0.2016_05_05_1515-a1 chromiumos_image.bin --force_developer_mode</div><div class="line"><span class="keyword">ERROR   </span>:     6 30796   746       00:00 00:00:00  0.0      \_ /bin/bash /mnt/host/source/src/scripts/update_bootloaders.sh --arch=amd64 --to=/mnt/host/source/src/build/images/amd64-generic/R52<span class="string">-8277</span>.0.2016_05_05_1515-a1/chromiumos_image.bin --from=/mnt/host/source/src/build/images/amd64-generic/R52<span class="string">-8277</span>.0.2016_05_05_1515-a1/rootfs_dir/boot --vmlinuz=/mnt/host/source/src/build/images/amd64-generic/R52<span class="string">-8277</span>.0.2016_05_05_1515-a1/rootfs_dir/boot/vmlinuz --to_offset=127926272 --to_size=16777216 --kernel_partition='/mnt/host/source/src/build/images/amd64-generic/R52<span class="string">-8277</span>.0.2016_05_05_1515-a1/vmlinuz.image' --install_syslinux</div><div class="line"><span class="keyword">ERROR   </span>:     6   746   958       00:00 00:00:00  0.0          \_ /bin/bash /mnt/host/source/src/scripts/update_bootloaders.sh--arch=amd64 --to=/mnt/host/source/src/build/images/amd64-generic/R52<span class="string">-8277</span>.0.2016_05_05_1515-a1/chromiumos_image.bin --from=/mnt/host/source/src/build/images/amd64-generic/R52<span class="string">-8277</span>.0.2016_05_05_1515-a1/rootfs_dir/boot --vmlinuz=/mnt/host/source/src/build/images/amd64-generic/R52<span class="string">-8277</span>.0.2016_05_05_1515-a1/rootfs_dir/boot/vmlinuz --to_offset=127926272 --to_size=16777216 --kernel_partition='/mnt/host/source/src/build/images/amd64-generic/R52<span class="string">-8277</span>.0.2016_05_05_1515-a1/vmlinuz.image' --install_syslinux</div><div class="line"><span class="keyword">ERROR   </span>:     6   958   959       00:00 00:00:00  0.0              \_ ps f -o pgid,ppid,pid,etime,cputime,%cpu,command</div><div class="line"><span class="keyword">ERROR   </span>: Arguments of 746:  '--arch=amd64' '--to=/mnt/host/source/src/build/images/amd64-generic/R52<span class="string">-8277</span>.0.2016_05_05_1515-a1/chromiumos_image.bin' '--from=/mnt/host/source/src/build/images/amd64-generic/R52<span class="string">-8277</span>.0.2016_05_05_1515-a1/rootfs_dir/boot''--vmlinuz=/mnt/host/source/src/build/images/amd64-generic/R52<span class="string">-8277</span>.0.2016_05_05_1515-a1/rootfs_dir/boot/vmlinuz' '--to_offset=127926272' '--to_size=16777216' '--kernel_partition='/mnt/host/source/src/build/images/amd64-generic/R52<span class="string">-8277</span>.0.2016_05_05_1515-a1/vmlinuz.image'' '--install_syslinux'</div><div class="line"><span class="keyword">ERROR   </span>: Backtrace:  (most recent call is last)</div><div class="line"><span class="keyword">ERROR   </span>:  update_bootloaders.sh:195:main(), called: die_err_trap  </div><div class="line"><span class="keyword">ERROR   </span>: </div><div class="line"><span class="keyword">ERROR   </span>: Command failed:</div><div class="line"><span class="keyword">ERROR   </span>:   Command 'sudo syslinux -d /syslinux "$&#123;ESP_DEV&#125;"' exited with nonzero code: 1</div><div class="line">umount: /tmp/esp.eZETwO: not mounted</div><div class="line">WARNING : Initial unmount failed. Possibly crosbug.com/23443. Retrying</div><div class="line">umount: /tmp/esp.eZETwO: not mounted</div><div class="line">INFO    : Unmounting image from /mnt/host/source/src/build/images/amd64-generic/R52<span class="string">-8277</span>.0.2016_05_05_1515-a1/stateful_dir and/mnt/host/source/src/build/images/amd64-generic/R52<span class="string">-8277</span>.0.2016_05_05_1515-a1/rootfs_dir</div><div class="line">Cleaning up /usr/local symlinks for /mnt/host/source/src/build/images/amd64-generic/R52<span class="string">-8277</span>.0.2016_05_05_1515-a1/stateful_dir/dev_image</div><div class="line"><span class="keyword">ERROR   </span>: 2016年 05月 05日 星期四 15:28:06 CST</div><div class="line"><span class="keyword">ERROR   </span>:  PGID  PPID   PID     ELAPSED     TIME %CPU COMMAND</div><div class="line"><span class="keyword">ERROR   </span>:     6     6    10       13:07 00:00:00  0.0 /bin/bash ./build_image --board=amd64-generic --noenable_rootfs_verification dev</div><div class="line"><span class="keyword">ERROR   </span>:     6    10 30796       00:30 00:00:00  0.2  \_ /bin/bash /mnt/host/source/src/scripts/bin/cros_make_image_bootable/mnt/host/source/src/build/images/amd64-generic/R52<span class="string">-8277</span>.0.2016_05_05_1515-a1 chromiumos_image.bin --force_developer_mode</div><div class="line"><span class="keyword">ERROR   </span>:     6 30796  1289       00:00 00:00:00  0.0      \_ /bin/bash /mnt/host/source/src/scripts/bin/cros_make_image_bootable /mnt/host/source/src/build/images/amd64-generic/R52<span class="string">-8277</span>.0.2016_05_05_1515-a1 chromiumos_image.bin--force_developer_mode</div><div class="line"><span class="keyword">ERROR   </span>:     6  1289  1290       00:00 00:00:00  0.0          \_ ps f -o pgid,ppid,pid,etime,cputime,%cpu,command</div><div class="line"><span class="keyword">ERROR   </span>: Arguments of 30796:  '/mnt/host/source/src/build/images/amd64-generic/R52<span class="string">-8277</span>.0.2016_05_05_1515-a1''chromiumos_image.bin' '--force_developer_mode'</div><div class="line"><span class="keyword">ERROR   </span>: Backtrace:  (most recent call is last)</div><div class="line"><span class="keyword">ERROR   </span>:  cros_make_image_bootable:430:main(), called: make_image_bootable '/mnt/host/source/src/build/images/amd64-generic/R52<span class="string">-8277</span>.0.2016_05_05_1515-a1/chromiumos_image.bin' </div><div class="line"><span class="keyword">ERROR   </span>:  cros_make_image_bootable:1:make_image_bootable(), called: die 'cros_make_image_bootable failed.' </div><div class="line"><span class="keyword">ERROR   </span>: </div><div class="line"><span class="keyword">ERROR   </span>: Error was:</div><div class="line"><span class="keyword">ERROR   </span>:   cros_make_image_bootable failed.</div></pre></td></tr></table></figure>
<p>Solve:</p>
<ol>
<li>I see that maybe it ‘s a bug :crosbug.com/23443</li>
<li>search in google group, find a url:<a href="https://bugs.chromium.org/p/chromium/issues/detail?id=508713" target="_blank" rel="external">https://bugs.chromium.org/p/chromium/issues/detail?id=508713</a><br>In comment12 , see somebody had solved the problem:<br><a href="https://chromium-review.googlesource.com/#/c/303962/1/update_bootloaders.sh" target="_blank" rel="external">https://chromium-review.googlesource.com/#/c/303962/1/update_bootloaders.sh</a><br>edit the update_bootloaders.sh and run the cros_sdk again</li>
</ol>
<p>Reason:<br>Maybe the reason is that<br>the The current mtools already takes a lock; it’s just not patient enough to wait for it and expecting the caller (Syslinux) to retry until available. Syslinux does not retry, does not look at the specific error code and just dies:<br>We cannot syslinux ESP_DEV directly because of a race condition with udev.</p>

      
    </div>

    <div>
      
        
      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/chromium/" rel="tag">#chromium</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/05/06/advanced-bash-scripting-guide-1-md/" rel="next" title="笔记 高级bash编程指南">
                <i class="fa fa-chevron-left"></i> 笔记 高级bash编程指南
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2016/05/07/spacemacs_offline/" rel="prev" title="Spacemacs 修改代理">
                Spacemacs 修改代理 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div class="ds-thread" data-thread-key="2016/05/06/chromium-build-1/"
           data-title="Chromium编译问题总结" data-url="http://junchaozhang.github.io/2016/05/06/chromium-build-1/">
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="https://avatars3.githubusercontent.com/u/6490080?v=3&s=460"
               alt="Junchao Zhang" />
          <p class="site-author-name" itemprop="name">Junchao Zhang</p>
          <p class="site-description motion-element" itemprop="description">My Blog</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">11</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              
                <span class="site-state-item-count">5</span>
                <span class="site-state-item-name">分类</span>
              
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">15</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">
            
              
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#关键部分"><span class="nav-number">1.</span> <span class="nav-text">关键部分:</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-问题1"><span class="nav-number">1.1.</span> <span class="nav-text">1. 问题1</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#解决"><span class="nav-number">1.1.1.</span> <span class="nav-text">解决:</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1-下载atk安装包"><span class="nav-number">1.1.1.1.</span> <span class="nav-text">1. 下载atk安装包</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-编译安装atk"><span class="nav-number">1.1.1.2.</span> <span class="nav-text">2. 编译安装atk:</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-编译安装pango"><span class="nav-number">1.1.1.3.</span> <span class="nav-text">3. 编译安装pango:</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#4-编译安装nss-The-Network-Security-Services-NSS-package"><span class="nav-number">1.1.1.4.</span> <span class="nav-text">4. 编译安装nss(The Network Security Services (NSS) package)</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-问题2"><span class="nav-number">1.2.</span> <span class="nav-text">2. 问题2</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-问题3"><span class="nav-number">1.3.</span> <span class="nav-text">3. 问题3</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-问题4"><span class="nav-number">1.4.</span> <span class="nav-text">4. 问题4</span></a></li></ol></li></ol></div>
            
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Junchao Zhang</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.0.1"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.0.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.0.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"bob12358"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
  






  
  
  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
       search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body").append('<div class="popoverlay">').css('overflow', 'hidden');
      $('.popup').toggle();

    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
    'use strict';
    $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
            // get the contents from search data
            isfetched = true;
            $('.popup').detach().appendTo('.header-inner');
            var datas = $( "entry", xmlResponse ).map(function() {
                return {
                    title: $( "title", this ).text(),
                    content: $("content",this).text(),
                    url: $( "url" , this).text()
                };
            }).get();
            var $input = document.getElementById(search_id);
            var $resultContent = document.getElementById(content_id);
            $input.addEventListener('input', function(){
                var matchcounts = 0;
                var str='<ul class=\"search-result-list\">';                
                var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                $resultContent.innerHTML = "";
                if (this.value.trim().length > 1) {
                // perform local searching
                datas.forEach(function(data) {
                    var isMatch = true;
                    var content_index = [];
                    var data_title = data.title.trim().toLowerCase();
                    var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                    var data_url = data.url;
                    var index_title = -1;
                    var index_content = -1;
                    var first_occur = -1;
                    // only match artiles with not empty titles and contents
                    if(data_title != '' && data_content != '') {
                        keywords.forEach(function(keyword, i) {
                            index_title = data_title.indexOf(keyword);
                            index_content = data_content.indexOf(keyword);
                            if( index_title < 0 && index_content < 0 ){
                                isMatch = false;
                            } else {
                                if (index_content < 0) {
                                    index_content = 0;
                                }
                                if (i == 0) {
                                    first_occur = index_content;
                                }
                            }
                        });
                    }
                    // show search results
                    if (isMatch) {
                        matchcounts += 1;
                        str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                        var content = data.content.trim().replace(/<[^>]+>/g,"");
                        if (first_occur >= 0) {
                            // cut out 100 characters
                            var start = first_occur - 20;
                            var end = first_occur + 80;
                            if(start < 0){
                                start = 0;
                            }
                            if(start == 0){
                                end = 50;
                            }
                            if(end > content.length){
                                end = content.length;
                            }
                            var match_content = content.substring(start, end);
                            // highlight all keywords
                            keywords.forEach(function(keyword){
                                var regS = new RegExp(keyword, "gi");
                                match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                            });
                            
                            str += "<p class=\"search-result\">" + match_content +"...</p>"
                        }
                        str += "</li>";
                    }
                })};
                str += "</ul>";
                if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
                if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
                $resultContent.innerHTML = str;
            });
            proceedsearch();
        }
    });}

    // handle and trigger popup window;
    $('.popup-trigger').mousedown(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };

    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".popoverlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>

  

  

  

</body>
</html>
